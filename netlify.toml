# Netlify – Spotliner (ספוטליינר)
# קליינט + API (פונקציית serverless)

[build]
  base    = "client"
  # התקנת תלויות הפונקציה (server + serverless-http) כדי שה-API יעבוד
  command = "(cd ../netlify/functions && npm install) && npm run build"
  publish = "dist"

[build.environment]
  NODE_VERSION = "20"
  NETLIFY      = "true"

# API ו-uploads → פונקציית השרת (לפני ה-SPA)
[[redirects]]
  from   = "/api/*"
  to     = "/.netlify/functions/server"
  status = 200

[[redirects]]
  from   = "/uploads/*"
  to     = "/.netlify/functions/server"
  status = 200

# SPA: כל נתיב שלא קובץ סטטי מנותב ל-index.html
[[redirects]]
  from   = "/*"
  to     = "/index.html"
  status = 200
